%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% chapter01 - Cyber-physical Systems
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
% >>>>>>>>>>>>>>> PLEASE NOTE <<<<<<<<<<<<<<<
%
% This file is not stand-alone compileable as it is, to make it compileable while writing uncomment the preamble below.
% In this case, you also have to uncomment the begin/end document statements.
% You can outcomment the preamble and the begin/end document statements again or erase them when handing in your contribution.
%
% If you use BibTex for your bibliography, please use \putbib[bibliography] to print your reference (see end of this file).
%
% you can use paths relative to your chapter dir, e.g. \figure{assets/fig1}.
%
% >>>>>>>>>>>>>>>>>>>><<<<<<<<<<<<<<<<<<<<<<<

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% you can uncomment the following preamble during development to make this file compileable.
%% Note that you need the svmult.cs file inside your chapter root dir to make this work.
%% Also note that if you need additional packages etc., you can add them here, but please
%% mark them somehow so the editor of this book knows you need them in the final book.
%% When you hand in your contribution, please uncomment or remove the preamble again.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% start of preamble
%\documentclass[
%graybox,
%envcountchap,
%natbib
%]{svmult}
\documentclass[
graybox,
envcountchap
]{svmult}

\usepackage[utf8]{inputenc}
\usepackage{type1cm}        % activate if the above 3 fonts are not available on your system

\usepackage{makeidx}         % allows index generation
\usepackage{graphicx}        % standard LaTeX graphics tool when including figure files
\usepackage{multicol}        % used for the two-column index
\usepackage[bottom]{footmisc}% places footnotes at page bottom

\usepackage{newtxtext}       % 
\usepackage{newtxmath}       % selects Times Roman as basic font

\usepackage{footmisc}

% Additional packages added. Add necessary packages here.
\usepackage[english]{babel}
\usepackage{siunitx}
\usepackage{amssymb}
\usepackage{pifont}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{listings}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{url}
\usepackage{mathtools}
\usepackage{lipsum}
\usepackage{import}
\usepackage{bibunits}
\usepackage{acronym}
\usepackage[nottoc]{tocbibind}
%\usepackage{numberpt}
\usepackage{todonotes}


\usepackage{tikz}
\usepackage{color}
\usetikzlibrary{calc,shapes,automata,backgrounds,petri}
\tikzstyle{haState}=[rectangle split,rectangle split parts=2,draw,align=center,rounded corners]


\newcommand*{\CHAPTERSROOT}{../.}	% root path for chapters.
\newcommand*{\chapterprefix}{01}	% your chapter number.

\makeindex % used for the subject index
%%end of preamble

%uncomment the \begin{document} statement to make this file stand-alone compileable.
\begin{document}

\begin{bibunit}
	
\title*{Cyber-physical Systems}
\author{Carlos Varela and Damien Zufferey}
	
\institute{
	Carlos Varela \at Rensselaer Polytechnic Institute, USA, \email{cvarela@cs.rpi.edu}
	\and Damien Zufferey \at Max Planck Institute for Software Systems, Germany \email{zufferey@mpi-sws.org}
	\and Gul Agha \at University of Illinois, USA, \email{agha@illinois.edu}
	\and Takuo Watanabe \at Tokyo Institute of Technology, Japan, \email{takuo@c.titech.ac.jp}
	\and Shoji Yuen \at Nagoya University, Japan, \email{yuen@is.nagoya-u.ac.jp}
	\and Marjan Sirjani \at MÃ¤lardalen University, Sweden, \email{marjan.sirjani@mdh.se}
}
\maketitle
	
\abstract{Please place your abstract here.}
	
%% content
\section{Programming Cyber Physical Systems: Introduction}\label{sec:1} %(3pp)

The term Cyber-Physical Systems (CPS) broadly covers any distributed computing infrastructure interacting with the physical world in a feedback loop.
At an high level, CPS integrates communication, computation, and control.
CPS is the evolution of embedded systems as communication and distribution becomes the norm.
Development and deployment of CPS is increasing~\cite{DBLP:journals/cacm/KumarK15}.
However, CPS present their own challenges from a software perspective as the usual software abstractions are not always suitable for CPS~\cite{Lee:EECS-2008-8}.
CPS combines the challenges of normal software with the extra complexity of sensing and acting on a dynamical system.
With both distributed software and hardware components acting in a shared world, CPS can communicate explicitly through the exchange of messages and implicitly through the environment.
Communication for CPS need to account for synchronization through messages, time, and the environment.

\todo[inline]{examples: Give concrete examples of CPS and the challenges for each of them}



\section{Models} %(3pp)

Many computational approaches have been developed for concurrent and real-time communication and computation, but few cover the combination of communication, and dynamic control of physical state.
In this section, we give a short overview of models used to formalize CPS.

    \subsection{Control theory}

    Control theory approach (plant model and feedback controller)

    \subsection{Hybrid/Timed Automata}

Modeling paradigms for hybrid systems such as hybrid automata and its extensions \cite{DBLP:conf/lics/Henzinger96,AlurGLS06,DBLP:journals/iandc/LynchSV03} allow expressive dynamics, but little support for compositional programming and reasoning about communication.
Hybrid Automaton extends discrete state-based models, i.e. automata, with the continuous evolution of a dynamical systems.
Each state of an hybrid automaton is associated with a set of ordinary differential equations (ODE) and an invariant.
The transitions are guarded with expressions ranging over the continuous variables.
Fig.~\ref{fig:HA-ex1} shows an hybrid automaton.

\begin{figure}
\centering
\input{assets/hybrid_automata_1}
\caption{Hybrid automata representing a bang-bang controller for an heating system.}
\label{fig:HA-ex1}
\end{figure}

An run of an hybrid automaton is an sequence of discrete \emph{jumps} and continuous \emph{flows}.
When the automaton is in a state, the continuous state changes, or flows, as described by the state's ODE.
A discrete jumps can happen when the guard of the corresponding transition evaluates to true.
A jump does two changes to the automaton: (1) it changes the automaton's state and (2) it can changes the values of the continuous states.

Hybrid automaton does not natively include any mechanism for communication.
Communication needs to be encoded within the finite state structure of the automaton.

For the most part, analysis algorithms for these models are intractable.
Timed automata~\cite{DBLP:journals/tcs/AlurD94} are a special case of hybrid automata where all the continuous dimension are clocks which increase at constant speed.
The guards on the transitions are limited to difference logic, i.e. inequalities with at most two clock variables.
This model is expressive enough to express real-time constraints and can by analyzed efficiently. %emptiness is PSpace


    \subsection{Process Algebra and Differential Dynamic Logic}

Hybrid process algebras \cite{RoundsS03,BERGSTRA2005215,10.1007/978-3-319-53733-7_8,DBLP:conf/case/CampbellTLPOF16} and Differential dynamic logic \cite{PlatzerBook,Platzer18,PlatzerT18} has been developed for the deductive verification for hybrid systems attempts to define logics and invariant-based reasoning to hybrid systems.
These models enable reasoning about arbitrarily complex concurrent and hybrid programs.
Differential dynamic logic is a general logical framework to deductively reason about hybrid systems.
It extends dynamic logic with differential operators and shows sound and (relatively) complete axiomatizations for the logic.
Keymaera \cite{QueselMLAP16} is an interactive theorem prover based on this approach and it has been used to successfully verify some complex models.
Extensions of differential dynamic logic have been used to model loosely coupled distributed hybrid systems \cite{Platzer12}.
However, it has not been extended with structured message-based concurrency or with resource reasoning.

\todo[inline]{explain what it is and give an example}

    \subsection{Markov Processes}

    another extension of state-based model but this time with probabilities

\section{Communication} %(4pp)

CPS need communication at the level of the controllers to acheive some goals.
At the physical level, the physical elements of a CPS influence with each other and the controllers need to adapt.
Communication between processes is the main mechanism, at the controller level, used when one process observations or actuation capabilities are insufficient to allow it to satifies its specification independently.
In Fig.~\ref{fig:HA-ex2}, we show an extension of the exmaple from Fig.~\ref{fig:HA-ex1} with two adjacent rooms each having its own heating system.
We highlight in {\color{red!90!black}red} the interaction of the two physical elements.
As the room are adjacents, heats spread between the two.
As presented, this system does not use communication.
However, we could imagine that there are constraint on the power for the system and that it is not possible to have both heating ON at the same time, i.e.~the lower right state does not exist.
In that case, coordination between the two controller is required.


\begin{figure}
\centering
\input{assets/hybrid_automata_2}
\caption{
    Hybrid automata representing a the product of two bang-bang controllers for an heating system.
}
\label{fig:HA-ex2}
\end{figure}

In the previous section, we introduced a models for CPS.
Now, we looks at the role and influence of communication models.

    \subsection{Synchronous rendez-vous communication}

Synchronous communication is arguabely the simplest communication model.
It is easy to define, e.g. $P \stackrel{!a}{\rightarrow} P' \land Q \stackrel{?a}{\rightarrow} Q' \Rightarrow P \mid Q \stackrel{\tau}{\rightarrow} P' \mid Q'$.
As it does not increas the state-space, i.e.~no channels as extra memory, it is also the easiest to analyze.

For CPS, synchronous communication is suitable for system's where the systems dynamic is slow w.r.t. the message propagaion delay.
However, synchronus communication has some drawback.
It this model, processes block both on sending and receiving.
Most message-passing implementation only blocks on receivng.
Therefore, is is often used in cunjunction with extra sufficient conditions to prevent bloquing.
For instance, a process is required to be ready to receive a messages at any time \cite{?}. \todo{find ref (interface automata ?)}


    \subsection{Actor Model}

    \subsection{Functional Reactive Programming}

    communication using streams

    \subsection{Session Types}

    % cvarela:  really needed here?  or just a ref to chapter 2?

    \subsection{Networked Control System}

    centralized vs distributed controller

\section{Communication Imperfection and Control} %(2pp)

    analogous to consistency question in distributed system but about the freshness of physical informations

    \subsection{Clock synchronization}

    a basis on which other functionality are built

    \subsection{Robustness against perturbation of communication}

    example: work on Skorokhod Distance by Ichiro Hasuo

    \subsection{Efficient use of communication}

    example: work by Sebastian Trimpe on event triggered and wireless control systems

    \subsection{Interpolation and extrapolation}

    example: tfs2 ROS library use timestamped messages to interpolate/extrapolate data

\section{Impact of the Physical Layer and the Communication} %(2pp)

    \subsection{Point-to-point vs broadcast communication}

    \subsection{Large number of processes}

    swarm / sensor networks

    \subsection{Line-of-sight / limited range}

    gossip protocol

\section{Open Research Questions} %(2-5pp)

    \subsection{Discrete vs continuous systems}

    Process algebra, actors, and others model discrete systems.
    Differential equations, calculus, and others model the physical world.

    \begin{itemize}
    \item How to incorporate continuous time and space into concurrency models?
    \item How to go beyond bi-simulation and observational equivalence to reason about continuous systems?
    \end{itemize}
    
    \subsection{Hardware/Software interface}

    Cyber-physical systems have a hardware (physical) and a software (cyber) component
    
    \begin{itemize}
    \item How to model SW/HW interface?
    \item Are real-time properties properly modeled?
    \item  How to tackle complexity via abstraction without losing key properties?  (Translucency vs black box approaches)
    \item How to verify infinite-space systems?
    \end{itemize}

    \subsection{Dealing with uncertainty}

    Stochastic nature of cyber-physical systems, e.g., weather, requires probabilistic approach.
    
    \begin{itemize}
    \item Are heterogeneous latencies, failure modes properly accounted for?
    \item How to accurately model, quantify, propagate uncertainty?
    \item Need for statistical reasoning libraries suitable for interactive/automated proof assistants.
    \end{itemize}

    \subsection{Modal logics and reasoning}
    
    \begin{itemize}
    \item  Is first-order logic sufficient to reason about cyber-physical systems?
    \item Are spatial logics, temporal logics, and combinations thereof better suited for specifying and reasoning about CPS?
    \item What are their expressive power?   Are there efficient decision procedures?  (SAT modulo theory approaches?)
    \end{itemize}

    \subsection{Robust control}

    Can we reason about properties of feedback loop control systems incorporating the above (hybrid, SW/HW/Network, uncertainty/failures, modal logics/reasoning)?
    
    \subsection{AI and data-driven systems}

    As more CPS are model-driven and more models are data-driven, how can we trust these systems?  Are there inherent theoretical limits to dynamic data-driven applications and systems? (e.g., Cramer-Rao lower bounds, etc.)

	% \section*{Appendix}\label{appendix}
	
	% Please place your appendix content here, if applicable.
	
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%% For your bibliography, you should use a bibtex .bib file and include it here.
	%% Note that the final reference lists styling might differ because it'll be styled in unified book layout.
	
	% \biblstarthook{
	%	text inserted here will be printed before the actual list of references, but only if there is at least one reference to %display. Delete this section if you don't need it.
	%}
	
	% \nocite{*}		%% uncomment if uncited references should be listed in the bibliography.
	
	%% uncomment and state path to your .bib to use a bibtex file as your bibliography.
	%% NOTE: relative paths don't work in \putbib => During development, you might delete the "\CHAPTERSROOT/chapter\chapterprefix/" part to refer to your bib file. When you're done, please make this path absolute by adding the prefix again.
	%%
	\putbib[\CHAPTERSROOT/chapter\chapterprefix/bibliography] %
	
\end{bibunit}
	
%% uncomment the \end{document} statement to make this file stand-alone compileable.
\end{document}
